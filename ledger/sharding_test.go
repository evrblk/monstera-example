package ledger

import (
	"testing"

	"github.com/stretchr/testify/require"
)

func TestShardByAccount(t *testing.T) {
	require := require.New(t)

	shardKeys := []struct {
		accountId uint64
		shardKey  []byte
	}{
		{17376851231650125672, []byte{178, 7, 218, 154}},
		{14628948223324556977, []byte{46, 31, 124, 110}},
		{1751470671340507281, []byte{164, 42, 125, 28}},
		{6763149481169304588, []byte{125, 145, 93, 210}},
		{11136876013375878895, []byte{138, 97, 80, 246}},
		{16090041183687674591, []byte{14, 202, 52, 179}},
		{7127639430204982479, []byte{62, 249, 185, 243}},
		{6595447089537874820, []byte{0, 98, 167, 200}},
		{17923085692488910785, []byte{163, 24, 87, 41}},
		{15757112472655114830, []byte{24, 59, 166, 15}},
		{15871906709802350342, []byte{230, 220, 101, 203}},
		{14919666396460505869, []byte{141, 128, 18, 103}},
		{8794325015676184705, []byte{247, 38, 76, 83}},
		{12600978486374563414, []byte{174, 136, 176, 246}},
		{6579129099398947268, []byte{65, 3, 71, 72}},
		{4739864060100052468, []byte{175, 147, 45, 152}},
		{11310490484901840969, []byte{122, 138, 210, 65}},
		{8373474670307082567, []byte{248, 92, 68, 246}},
		{5746620668884576943, []byte{188, 144, 139, 0}},
		{9558860126251272523, []byte{93, 92, 132, 77}},
		{13985925788585237191, []byte{250, 160, 151, 240}},
		{7293646533687543803, []byte{60, 109, 202, 242}},
		{9403020216274906949, []byte{178, 7, 235, 88}},
		{15440301518099495680, []byte{73, 4, 253, 214}},
		{7180654138282459414, []byte{244, 6, 100, 150}},
		{10119597052720437179, []byte{205, 115, 168, 125}},
		{18443347492021908631, []byte{116, 148, 11, 90}},
		{9735171730952140036, []byte{84, 40, 227, 105}},
		{5808650851939104861, []byte{110, 160, 128, 250}},
		{3859041861362602657, []byte{52, 33, 240, 37}},
		{6281928159403879702, []byte{244, 190, 96, 70}},
		{15673285985263028280, []byte{86, 132, 227, 224}},
		{8540866234086761071, []byte{76, 32, 111, 73}},
		{8007332005972403716, []byte{100, 217, 31, 188}},
		{9150993217383508317, []byte{100, 198, 208, 150}},
		{1725591270889956794, []byte{194, 162, 79, 119}},
		{7975606528502053195, []byte{243, 126, 135, 18}},
		{8958245278108782096, []byte{98, 42, 62, 136}},
		{13411697099211290251, []byte{216, 227, 238, 199}},
		{14594004509059650107, []byte{166, 162, 32, 186}},
		{8072746296566822138, []byte{101, 91, 241, 220}},
		{14408690688712370291, []byte{56, 15, 71, 126}},
		{4206064898567628801, []byte{89, 41, 168, 89}},
		{8729224867940411327, []byte{235, 251, 72, 88}},
		{8584883633705651473, []byte{4, 246, 228, 124}},
		{13838522820363407493, []byte{81, 91, 151, 170}},
		{3822969027588357626, []byte{241, 97, 43, 64}},
		{117844201950081302, []byte{53, 140, 234, 123}},
		{14842970301484762655, []byte{173, 160, 158, 130}},
		{3994935833773449723, []byte{249, 150, 101, 18}},
		{9478906377469331836, []byte{66, 189, 250, 81}},
		{6099349696100272534, []byte{206, 204, 98, 8}},
		{9681152772021921465, []byte{165, 133, 170, 62}},
		{9748899750853686263, []byte{25, 75, 52, 148}},
		{7798762148348573710, []byte{91, 53, 148, 249}},
		{17832147556022929098, []byte{168, 183, 32, 230}},
		{12411618242800149088, []byte{121, 148, 0, 131}},
		{7223609158320384839, []byte{23, 13, 194, 116}},
		{18051316416951321770, []byte{62, 228, 158, 133}},
		{79920803592638678, []byte{126, 94, 142, 114}},
		{12396919197262581517, []byte{206, 111, 200, 129}},
		{4715385208595066955, []byte{37, 241, 199, 37}},
		{1092087973755636526, []byte{230, 85, 123, 91}},
		{17398772195986040524, []byte{229, 66, 38, 154}},
		{28286731689225825, []byte{122, 53, 213, 173}},
		{12008311054996868283, []byte{215, 114, 9, 40}},
		{9226623314013924328, []byte{170, 231, 115, 220}},
		{5345665741959996714, []byte{241, 17, 22, 252}},
		{14577677397207251921, []byte{70, 55, 136, 70}},
		{16908875683354942313, []byte{153, 12, 230, 153}},
		{14628343771063326736, []byte{89, 0, 150, 96}},
		{5596430216735958122, []byte{89, 236, 193, 101}},
		{11449409112049438772, []byte{208, 127, 35, 216}},
		{1836303706116694553, []byte{37, 29, 167, 207}},
		{3581976345100797273, []byte{239, 230, 94, 108}},
		{5638655480348827953, []byte{241, 27, 110, 62}},
		{5588471124545658495, []byte{229, 128, 132, 30}},
		{1683811582266963258, []byte{148, 5, 45, 118}},
		{3542363595584934515, []byte{184, 33, 1, 210}},
		{18294684754635483392, []byte{244, 5, 55, 195}},
		{6986934241880941445, []byte{138, 109, 93, 163}},
		{6111718747433730014, []byte{254, 107, 114, 122}},
		{4991511065513716292, []byte{21, 5, 25, 250}},
		{2716159264616985122, []byte{200, 124, 216, 45}},
		{17698383813805163172, []byte{134, 164, 123, 170}},
		{14900818914385177565, []byte{71, 87, 65, 119}},
		{14814170884203907826, []byte{146, 175, 175, 24}},
		{8314074577342745774, []byte{1, 92, 85, 250}},
		{4288399921563767338, []byte{143, 168, 141, 196}},
		{5838715209026728338, []byte{142, 218, 139, 249}},
		{3321409712889219365, []byte{229, 134, 235, 157}},
		{15748147471597939947, []byte{133, 202, 246, 148}},
		{17245844333763084363, []byte{230, 8, 177, 111}},
		{15180909357943496063, []byte{154, 151, 42, 77}},
		{9361545738043530784, []byte{39, 101, 210, 239}},
		{15017399364678582759, []byte{241, 80, 31, 108}},
		{4868017613491733747, []byte{75, 93, 249, 97}},
		{5783629783995277169, []byte{78, 44, 98, 102}},
		{192962560247404185, []byte{235, 210, 122, 104}},
		{2677880279274197255, []byte{48, 247, 93, 64}},
	}

	for _, d := range shardKeys {
		actual := shardByAccount(d.accountId)
		require.Equal(d.shardKey, actual)
	}
}
